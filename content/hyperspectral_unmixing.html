<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kenneth Leo">

<title>Physics 312 - Advanced Mathematical Physics II - Hyperspectral Unmixing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../content/report.html" rel="next">
<link href="../content/diffusion.html" rel="prev">
<link href="../images/favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Hyperspectral Unmixing</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Physics 312 - Advanced Mathematical Physics II</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/language-model.html" class="sidebar-item-text sidebar-link">Language Models</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/diffusion.html" class="sidebar-item-text sidebar-link">Diffusion Models</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/hyperspectral_unmixing.html" class="sidebar-item-text sidebar-link active">Hyperspectral Unmixing</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../content/report.html" class="sidebar-item-text sidebar-link">Report</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#hyperspectral-unmixing" id="toc-hyperspectral-unmixing" class="nav-link active" data-scroll-target="#hyperspectral-unmixing">Hyperspectral Unmixing</a></li>
  <li><a href="#principal-component-analysis" id="toc-principal-component-analysis" class="nav-link" data-scroll-target="#principal-component-analysis">Principal Component Analysis</a></li>
  <li><a href="#endmember-extraction-methods-with-pure-pixels" id="toc-endmember-extraction-methods-with-pure-pixels" class="nav-link" data-scroll-target="#endmember-extraction-methods-with-pure-pixels">Endmember Extraction Methods (with pure pixels)</a></li>
  <li><a href="#endmember-extraction-methods-without-pure-pixels" id="toc-endmember-extraction-methods-without-pure-pixels" class="nav-link" data-scroll-target="#endmember-extraction-methods-without-pure-pixels">Endmember Extraction Methods (without pure pixels)</a>
  <ul class="collapse">
  <li><a href="#endmembers-versus-archetypes." id="toc-endmembers-versus-archetypes." class="nav-link" data-scroll-target="#endmembers-versus-archetypes.">Endmembers versus archetypes.</a></li>
  </ul></li>
  <li><a href="#abundance-estimation-and-error-minimization" id="toc-abundance-estimation-and-error-minimization" class="nav-link" data-scroll-target="#abundance-estimation-and-error-minimization">Abundance Estimation and Error Minimization</a></li>
  <li><a href="#applications-of-hyperspectral-unmixing" id="toc-applications-of-hyperspectral-unmixing" class="nav-link" data-scroll-target="#applications-of-hyperspectral-unmixing">Applications of Hyperspectral Unmixing</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/kennethmleo/Physics312/edit/main/content/hyperspectral_unmixing.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/kennethmleo/Physics312/blob/main/content/hyperspectral_unmixing.qmd" class="toc-action">View source</a></p><p><a href="https://github.com/kennethmleo/Physics312/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Hyperspectral Unmixing</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kenneth Leo </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="hyperspectral-unmixing" class="level2">
<h2 class="anchored" data-anchor-id="hyperspectral-unmixing">Hyperspectral Unmixing</h2>
<p>The rough definition of hyperspectral unmixing is that you have this hyperspectral image such that each pixel of this image is actually a combination of multiple “spectra” or spectral signatures, then basically you are tasked to unmix or untangle these spectra to identify the components or endmembers that make up the image, and their respective abundance. The endmembers are the components of each pixel and the abundance represents the fraction of each endmember in a pixel. In the image below, we see how hyperspectral unmixing works.</p>
<div id="fig-hyperspectral" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="hyperspectral_unmixing.jpg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Hyperspectral unmixing concept in the remote sensing applicative context (<span class="citation" data-cites="DOBIGEON2016185">(<a href="#ref-DOBIGEON2016185" role="doc-biblioref">Dobigeon et al. 2016</a>)</span>)</figcaption><p></p>
</figure>
</div>
<p>So in general, there are three steps in hyperspectral unmixing:</p>
<ol type="1">
<li>Endmember selection</li>
<li>Abundance estimation</li>
<li>Error minimization</li>
</ol>
</section>
<section id="principal-component-analysis" class="level2">
<h2 class="anchored" data-anchor-id="principal-component-analysis">Principal Component Analysis</h2>
<p>For example, if we have this signal on the right, it is actually composed multiple signals of different forms. And we can perform principal component analysis to identify the signals that form it. We can also set a certain threshold such that we only choose as actual data the first <span class="math inline">\(n\)</span> signals that represent 95% of the data. All signals after the first <span class="math inline">\(n\)</span> signals will now be considered as noise.</p>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.io</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA, IncrementalPCA</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>pd.options.mode.chained_assignment <span class="op">=</span> <span class="va">None</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> scipy.io.loadmat(<span class="st">'munsell400_700_5.mat'</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>munsell <span class="op">=</span> data[<span class="st">'munsell'</span>]</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>wavelength <span class="op">=</span> np.arange(<span class="dv">400</span>,<span class="dv">700</span><span class="op">+</span><span class="dv">5</span>,<span class="dv">5</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>df_fluorescent <span class="op">=</span> pd.read_excel(<span class="st">"Fluorescents.xls"</span>, skiprows <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>df_fluorescent.rename(columns<span class="op">=</span>{<span class="st">'Unnamed: 0'</span>:<span class="st">'wavelength'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>df_fluorescentF1 <span class="op">=</span> df_fluorescent[[<span class="st">'wavelength'</span>, <span class="st">'F1'</span>]]</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>df_fluorescentF1.rename(columns <span class="op">=</span> {<span class="st">'F1'</span>:<span class="st">'illumination'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>df_fluorescentF1 <span class="op">=</span> df_fluorescentF1[(df_fluorescentF1[<span class="st">'wavelength'</span>] <span class="op">&gt;=</span> <span class="dv">400</span>) <span class="op">&amp;</span> (df_fluorescentF1[<span class="st">'wavelength'</span>] <span class="op">&lt;=</span> <span class="dv">700</span>)]</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>df_fluorescentF1 <span class="op">=</span> df_fluorescentF1.reset_index(inplace<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>color_signal <span class="op">=</span> []</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">enumerate</span>(munsell):</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    color_signal.append(j <span class="op">*</span> df_fluorescentF1.illumination[i])</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>color_signal <span class="op">=</span> np.array(color_signal)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA(<span class="bu">len</span>(color_signal))</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>pca.fit(color_signal.T)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>mean <span class="op">=</span> pca.mean_</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>evecs <span class="op">=</span> pca.components_</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>evals <span class="op">=</span> pca.explained_variance_ratio_</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>explained <span class="op">=</span> pca.explained_variance_ratio_.cumsum() <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>accuracy <span class="op">=</span> <span class="dv">95</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> np.argmax(explained<span class="op">&gt;</span>accuracy)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Number of components explaining 95% variance: "</span><span class="op">+</span> <span class="bu">str</span>(k<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">9</span><span class="op">*</span><span class="dv">3</span>,<span class="dv">6</span>))</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">131</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>plt.plot(wavelength, df_fluorescentF1.illumination, color <span class="op">=</span> <span class="st">'orange'</span>)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="co">#plt.ylim(-0.05,1.05)</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'relative intensity'</span>, fontsize <span class="op">=</span> <span class="dv">15</span>)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'wavelength'</span>,fontsize <span class="op">=</span> <span class="dv">15</span>)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">132</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>plt.plot(np.arange(<span class="dv">0</span>,<span class="bu">len</span>(munsell))<span class="op">+</span><span class="dv">1</span>, explained, <span class="st">'o-'</span>, color <span class="op">=</span> <span class="st">'black'</span>)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Cumulative explained variance ratio'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'number of principal components'</span>, fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>plt.axvline(x<span class="op">=</span>k<span class="op">+</span><span class="dv">1</span>, color<span class="op">=</span><span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span>accuracy, color<span class="op">=</span><span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">133</span>)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="st">'eigenvector 1'</span>, <span class="st">'eigenvector 2'</span>, <span class="st">'eigenvector 3'</span>]</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'#00008B'</span>, <span class="st">'Turquoise'</span>, <span class="st">'#D2BD96'</span>]</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(k<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    pc <span class="op">=</span> evecs[i]</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>    plt.plot(wavelength, pc, color <span class="op">=</span> colors[i], label <span class="op">=</span> labels[i])</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>plt.legend(fontsize <span class="op">=</span> <span class="dv">14</span>)</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'wavelength'</span>,fontsize <span class="op">=</span> <span class="dv">15</span>)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Number of components explaining 95% variance: 3</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="hyperspectral_unmixing_files/figure-html/cell-2-output-2.png" width="2080" height="510"></p>
</div>
</div>
<p><em>Pitfall of using PCA only</em>: Endmembers cannot be estimated completely just by using PCA. Reason for this is that in real images, the spectral data is nonlinear in nature.</p>
</section>
<section id="endmember-extraction-methods-with-pure-pixels" class="level2">
<h2 class="anchored" data-anchor-id="endmember-extraction-methods-with-pure-pixels">Endmember Extraction Methods (with pure pixels)</h2>
<ol type="1">
<li>Pixel Purity Index <span class="citation" data-cites="8080725">(<a href="#ref-8080725" role="doc-biblioref">Heylen and Scheunders 2013</a>)</span></li>
</ol>
<ul>
<li>From what I understood, you can identify which pixels of an image is “pure”. So for example, in an image, a pixel that only contain a cloud particle can be thought of as a “pure cloud pixel”. The existence of these pure pixels and a pure pixel index scores is important in a sense that only pixels whose PPI scores under a certain threshold are considered as endmembers.</li>
<li>This algorithm is one of the endmember extraction algorithm made that is still very popular up to this day.</li>
</ul>
<ol start="2" type="1">
<li>N-FINDR Algorithm</li>
</ol>
<ul>
<li>For this algorithm, we reduce the dimensionality of the data using princpical component analysis. The number of endmembers is equal to the number of principal components in this algorithm. This algorithm is an iterative approach where the volume of a simplex formed by endmembers are maximized.</li>
</ul>
<ol start="3" type="1">
<li>Orthogonal Subspace Projection <span class="citation" data-cites="Chang_2005">(<a href="#ref-Chang_2005" role="doc-biblioref">Chang 2005</a>)</span></li>
</ol>
<ul>
<li>The essence of this algorithm is that two spectral bands are separated such that these two bands are as orthogonal to each other. If this is the case, that means one band will not share its information with another band. A requirement for this to work is that the number of spectral bands should be less than the target signature of interest.</li>
</ul>
<ol start="4" type="1">
<li>Vertex Component Analysis</li>
</ol>
<p><em>Pitfall/s:</em> Realistically speaking, pure pixels dont exist. This is why we have algorithms that assumes the absence of pure pixels.</p>
</section>
<section id="endmember-extraction-methods-without-pure-pixels" class="level2">
<h2 class="anchored" data-anchor-id="endmember-extraction-methods-without-pure-pixels">Endmember Extraction Methods (without pure pixels)</h2>
<p>For this part, I’m just going to copy what the ParTI website said because I have understood that well and I think they were able to summarize and discuss everything in this part (<span class="citation" data-cites="NA_2022">(<a href="#ref-NA_2022" role="doc-biblioref">N/A 2022</a>)</span>). Other discussions are summarized from multiple papers and online articles I have read trying to understand each algorithms.</p>
<p>When there are no pure pixels algorithms used are going to be minimum volume-based but with different approaches.</p>
<ol type="1">
<li>SISAL (Simple Identification via variable Splitting and augmented Lagrangian)</li>
</ol>
<ul>
<li>Minimizes the volume of the simplex that encapsulates the data. It is resilient to noise and outliers - data points can end outside of the simplex. Usually archetype are located outside the data.</li>
<li>Basically, SISAL is useful in applications where there is a required constrained optimization. From the name itself, SISAL splits the unmixing process into two parts: a variable the represents the abundance of the endmembers in each pixel and a variable that helps hold constraints (non-negative abundance or sum-to-one). Now for the second part of the name, SISAL constructs an augmented Lagragian such that it applies a penalty that is based on the optimization algorithm. This will then be used to guide the optimization process. The algorithm will then iterate based on an error criterion or a set number of iterations. In each iteration, the abundance of each endmember will be calculated and updated based on the penalty and constraints given.</li>
</ul>
<ol start="2" type="1">
<li>MVSA/MVES (Minimum Volume Simplex Analysis/Minimum Volume Enclosing Simplex)</li>
</ol>
<ul>
<li>Minimizes the volume of the simplex that encapsulates the data. It is not resilient to noise and outliers - data points will all be inside the simplex.</li>
</ul>
<ol start="3" type="1">
<li>SDVMM (Successive Decoupled Volume Max-Min)</li>
</ol>
<ul>
<li>data points are selected as archetypes, maximizing the variance of the data encapsulated within the resulting simplex. By Selecting tolerance radius around the points selected as archetypes, one can expand the simplex. In general, the archetypes are located within the data.</li>
</ul>
<ol start="4" type="1">
<li>PCHA (Principal Convex Hull Analysis)</li>
</ol>
<ul>
<li>archetypes are found within the convex hull of the data, maximizing the data encapsulated within the resulting simplex. By selecting a tolerance radius around the points selected as archetypes, one can expand the simplex. In general, the archetypes are located within the data.</li>
</ul>
<p>For large datasets of thousands data points, the three minimal bounding simplex algorithms (SISAL, MVSA and MVES) give very similar results. We found that the SISAL algorithm performs best since it takes good care of outliers in the dataset and gives the tightest simplex enclosing most of the data points. It is then also natural to use SISAL for calculation of the simplex statistical significance.</p>
<p>However, when the number of data points is on the order of a hundred or less, the SISAL algorithm might ignore important points when calculating the enclosing simplex. This is most relevant when calculating the statistical significance of the simplex. In such cases we used the MVSA algorithm.</p>
<section id="endmembers-versus-archetypes." class="level3">
<h3 class="anchored" data-anchor-id="endmembers-versus-archetypes.">Endmembers versus archetypes.</h3>
<p>Okay so here, I got confused when I was reading the slides and other papers (Cricri’s SPP paper about voting patterns). So I did more research about the difference of endmembers and archetypes. From what I read, endmembers are these materials in the hyperspectral image, trees, rocks, clouds, etc. These endmembers now have a spectra which we call the endmember signature. Each pixel in our image is then represented by a linear combination of these endmembers with their respective abundance values.</p>
<p><span class="math display">\[
\text{pixel} = \text{endmember}_1 * \text{abundance}_1 + \text{endmember}_2 * \text{abundance}_2 + ... + \text{endmember}_n * \text{abundance}_n
\]</span></p>
<p>Archetypes, on the other hand, are the spectral signatures of endmembers. That means they can be a combination of multiple endmembers. For example, one archetype can represent a group of trees. Archetypes are more useful to represent more complex materials with different spectral variatons.</p>
</section>
</section>
<section id="abundance-estimation-and-error-minimization" class="level2">
<h2 class="anchored" data-anchor-id="abundance-estimation-and-error-minimization">Abundance Estimation and Error Minimization</h2>
<p>After identifying the endmembers of our image, next thing to do is to estimate the fraction of endmembers in each pixel, quantified by abundance. One of the easiest ways to estimate abundance is by least squares. When calculating the abundance, the sum-to-one and non-negative constraints should be considered when calculating the least squares. Now, the process in estimating abundance is iterative such that the reconstruction error (obtained using the endmembers and abundance estimated) is minimized when compared to the original hyperspectral image.</p>
</section>
<section id="applications-of-hyperspectral-unmixing" class="level2">
<h2 class="anchored" data-anchor-id="applications-of-hyperspectral-unmixing">Applications of Hyperspectral Unmixing</h2>
<p>One of the cool things that we can use hyperspectral unmixing for is to discover voting patterns of people using an election dataset <span class="citation" data-cites="Cricri_spp">(<a href="#ref-Cricri_spp" role="doc-biblioref">Castro and Lim 2020</a>)</span>. In the paper, they were able to identify the archetypes in an election dataset: that is the voting distribution of people. They found recurring archetypes across different election periods. With this paper, we see that hyperspectral unmixing can also be used to different types of data as long as these data contain some sort of “components” that can be unmixed.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Cricri_spp" class="csl-entry" role="doc-biblioentry">
Castro, Crizzia Mielle Mariano de, and May Tan Lim. 2020. <span>“Extracting Voting Patterns Across Three Philippine Senate Elections Using Hyperspectral Unmixing.”</span> In <em>Proceedings of the Samahang Pisika Ng Pilipinas</em>, 38:SPP-2020-2A-06. <a href="https://proceedings.spp-online.org/article/view/SPP-2020-2A-06">https://proceedings.spp-online.org/article/view/SPP-2020-2A-06</a>.
</div>
<div id="ref-Chang_2005" class="csl-entry" role="doc-biblioentry">
Chang, Chein-I. 2005. <span>“Orthogonal Subspace Projection (OSP) Revisited: A Comprehensive Study and Analysis.”</span> <em>IEEE Transactions on Geoscience and Remote Sensing</em> 43 (3): 502–18. <a href="https://doi.org/10.1109/tgrs.2004.839543">https://doi.org/10.1109/tgrs.2004.839543</a>.
</div>
<div id="ref-DOBIGEON2016185" class="csl-entry" role="doc-biblioentry">
Dobigeon, N., Y. Altmann, N. Brun, and S. Moussaoui. 2016. <span>“Chapter 6 - Linear and Nonlinear Unmixing in Hyperspectral Imaging.”</span> In <em>Resolving Spectral Mixtures</em>, edited by Cyril Ruckebusch, 30:185–224. Data Handling in Science and Technology. Elsevier. https://doi.org/<a href="https://doi.org/10.1016/B978-0-444-63638-6.00006-1">https://doi.org/10.1016/B978-0-444-63638-6.00006-1</a>.
</div>
<div id="ref-8080725" class="csl-entry" role="doc-biblioentry">
Heylen, Rob, and Paul Scheunders. 2013. <span>“Multi-Dimensional Pixel Purity Index.”</span> In <em>2013 5th Workshop on Hyperspectral Image and Signal Processing: Evolution in Remote Sensing (WHISPERS)</em>, 1–4. <a href="https://doi.org/10.1109/WHISPERS.2013.8080725">https://doi.org/10.1109/WHISPERS.2013.8080725</a>.
</div>
<div id="ref-NA_2022" class="csl-entry" role="doc-biblioentry">
N/A, N/A. 2022. <span>“Pareto Task Inference (Parti) Method.”</span> <em>Uri Alon</em>. https://www.weizmann.ac.il/mcb/UriAlon/download/ParTI.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../content/diffusion.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Diffusion Models</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../content/report.html" class="pagination-link">
        <span class="nav-page-text">Report</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© CC-1.0</div>   
    <div class="nav-footer-right">This page is built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>